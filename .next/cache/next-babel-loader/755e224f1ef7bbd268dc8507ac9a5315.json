{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport axios from 'axios';\nimport appconfig from \"../config/appconfig\";\nimport { useRouter } from 'next/router';\nimport { message } from \"antd\"; // eslint-disable-next-line react-hooks/rules-of-hooks\n\nconst router = () => {\n  _s();\n\n  return useRouter();\n};\n\n_s(router, \"CeygcqajjFExIxFEzW4x/gfWEGQ=\", false, function () {\n  return [useRouter];\n});\n\nclass GlobalService {\n  constructor() {\n    this.service = axios.create({\n      baseURL: appconfig.tmdbEndpoint,\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n    this.setInterceptors();\n  }\n\n  setInterceptors() {\n    console.log(this);\n    this.service.interceptors.request.use(function (config) {\n      return config;\n    }, function (error) {\n      return Promise.reject(error);\n    });\n    this.service.interceptors.response.use(function (response) {\n      return response;\n    }, function (error) {\n      console.log(this);\n      this.callErrorHandler(error);\n      return Promise.reject(error);\n    });\n  }\n\n  get(url, config) {\n    return new Promise(async (res, rej) => {\n      let response = await this.service.get(url, config);\n      res(response);\n    }).catch(error => {\n      var _error$response, _error$response$data;\n\n      message.error(error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.error);\n    });\n  }\n\n  post(url, data, config) {\n    return new Promise(async (res, rej) => {\n      let response = await this.service.post(url, data, config);\n      res(response);\n    }).catch(error => {\n      var _error$response2, _error$response2$data;\n\n      message.error(error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error);\n    });\n  }\n\n  callErrorHandler(error) {\n    switch (error.status) {\n      case 401:\n        this.handle401(error);\n        break;\n\n      default:\n        this.handleDefault(error);\n        break;\n    }\n  }\n\n  handle401(error) {\n    console.log(error);\n    sessionStorage.clear();\n    router.push({\n      pathname: '/error',\n      query: {\n        error: error\n      }\n    });\n  }\n\n  handleDefault(error) {\n    console.log(error);\n  }\n\n}\n\nconst globalService = new GlobalService();\nexport default globalService;","map":{"version":3,"sources":["C:/Film_Focus_2/film-focus-2/src/services/globalService.js"],"names":["axios","appconfig","useRouter","message","router","GlobalService","constructor","service","create","baseURL","tmdbEndpoint","headers","setInterceptors","console","log","interceptors","request","use","config","error","Promise","reject","response","callErrorHandler","get","url","res","rej","catch","data","post","status","handle401","handleDefault","sessionStorage","clear","push","pathname","query","globalService"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport appconfig from \"../config/appconfig\";\r\nimport { useRouter } from 'next/router';\r\nimport { message } from \"antd\";\r\n\r\n// eslint-disable-next-line react-hooks/rules-of-hooks\r\nconst router = () => {return useRouter();}\r\n\r\nclass GlobalService {\r\n  constructor() {\r\n    this.service = axios.create({\r\n      baseURL: appconfig.tmdbEndpoint,\r\n      headers: {\r\n        \"Content-Type\": \"application/json\"\r\n      }\r\n    })\r\n\r\n    this.setInterceptors();\r\n  }\r\n\r\n  setInterceptors() {\r\n    console.log(this)\r\n    this.service.interceptors.request.use(function(config) {\r\n      return config;\r\n    }, function(error) {\r\n      return Promise.reject(error);\r\n    })\r\n\r\n    this.service.interceptors.response.use(function(response) {\r\n      return response;\r\n    }, function(error) {\r\n      console.log(this)\r\n      this.callErrorHandler(error)\r\n      return Promise.reject(error);\r\n    })\r\n  }\r\n\r\n  get(url, config) {\r\n    return new Promise(async (res, rej) => {\r\n      let response = await this.service.get(url, config);\r\n      res(response);\r\n    }).catch((error) => {\r\n      message.error(error?.response?.data?.error);\r\n    });\r\n  }\r\n\r\n  post(url, data, config) {\r\n    return new Promise(async (res, rej) => {\r\n      let response = await this.service.post(url, data, config);\r\n      res(response);\r\n    }).catch((error) => {\r\n      message.error(error?.response?.data?.error);\r\n    });\r\n  }\r\n\r\n  callErrorHandler(error) {\r\n    switch(error.status) {\r\n      case 401:\r\n        this.handle401(error);\r\n        break;\r\n      default:\r\n        this.handleDefault(error);\r\n        break;\r\n    }\r\n  }\r\n\r\n  handle401(error) {\r\n    console.log(error);\r\n    sessionStorage.clear();\r\n    router.push({\r\n      pathname: '/error',\r\n      query: {\r\n        error: error\r\n      }\r\n    });\r\n  }\r\n\r\n  handleDefault(error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst globalService = new GlobalService();\r\nexport default globalService;"]},"metadata":{},"sourceType":"module"}