{"ast":null,"code":"import axios from 'axios';\nimport appconfig from \"../config/appconfig\";\n\nclass GlobalService {\n  constructor() {\n    this.service = axios.create({\n      baseURL: appconfig.tmdbEndpoint,\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n\n    let _this = this;\n\n    this.service.interceptors.request.use(function (config) {\n      return config;\n    }, function (error) {\n      return Promise.reject(error);\n    });\n    this.service.interceptors.response.use(function (response) {\n      return response;\n    }, function (error) {\n      _this.callErrorHandler(error.response);\n\n      return Promise.reject(error);\n    });\n  }\n\n  get(url, config) {\n    return new Promise(async (res, rej) => {\n      try {\n        let response = await this.service.get(url, config);\n        res(response);\n      } catch (error) {\n        console.log(\"rej\");\n        rej();\n      }\n    });\n  }\n\n  post(url, data, config) {\n    return new Promise(async (res, rej) => {\n      try {\n        let response = await this.service.post(url, data, config);\n        res(response);\n      } catch (error) {\n        rej();\n      }\n    });\n  }\n\n  callErrorHandler(error) {\n    console.log(\"here\");\n\n    switch (error.status) {\n      case 401:\n        this.handle401(error);\n        break;\n\n      default:\n        this.handleDefault(error);\n        break;\n    }\n  }\n\n  redirect(statusCode) {\n    console.log(`localhost:3000/error?status=${statusCode}`);\n    window.open(`localhost:3000/error?status=${statusCode}`, \"_self\");\n  }\n\n  handle401(error) {\n    console.log(error);\n    sessionStorage.clear();\n    this.redirect(error.status);\n  }\n\n  handleDefault(error) {\n    console.log(error);\n  }\n\n}\n\nconst globalService = new GlobalService();\nexport default globalService;","map":{"version":3,"sources":["C:/Film_Focus_2/film-focus-2/src/services/globalService.ts"],"names":["axios","appconfig","GlobalService","constructor","service","create","baseURL","tmdbEndpoint","headers","_this","interceptors","request","use","config","error","Promise","reject","response","callErrorHandler","get","url","res","rej","console","log","post","data","status","handle401","handleDefault","redirect","statusCode","window","open","sessionStorage","clear","globalService"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport appconfig from \"../config/appconfig\";\r\n\r\nclass GlobalService {\r\n  [x: string]: any;\r\n  constructor() {\r\n    this.service = axios.create({\r\n      baseURL: appconfig.tmdbEndpoint,\r\n      headers: {\r\n        \"Content-Type\": \"application/json\"\r\n      }\r\n    })\r\n\r\n    let _this = this;\r\n    this.service.interceptors.request.use(function(config) {\r\n      return config;\r\n    }, function(error) {\r\n      return Promise.reject(error);\r\n    })\r\n\r\n    this.service.interceptors.response.use(function(response) {\r\n      return response;\r\n    }, function(error) {\r\n      _this.callErrorHandler(error.response)\r\n      return Promise.reject(error);\r\n    })\r\n  }\r\n\r\n  get(url, config) {\r\n    return new Promise(async (res, rej) => {\r\n      try {\r\n        let response = await this.service.get(url, config);\r\n        res(response);\r\n      } catch(error) {\r\n        console.log(\"rej\")\r\n        rej();\r\n      }\r\n    })\r\n  }\r\n\r\n  post(url, data, config) {\r\n    return new Promise(async (res, rej) => {\r\n      try {\r\n        let response = await this.service.post(url, data, config);\r\n        res(response);\r\n      } catch (error) {\r\n        rej();\r\n      }\r\n    })\r\n  }\r\n\r\n  private callErrorHandler(error) {\r\n    console.log(\"here\")\r\n    switch(error.status) {\r\n      case 401:\r\n        this.handle401(error);\r\n        break;\r\n      default:\r\n        this.handleDefault(error);\r\n        break;\r\n    }\r\n  }\r\n\r\n  private redirect(statusCode) {\r\n    console.log(`localhost:3000/error?status=${statusCode}`)\r\n    window.open(`localhost:3000/error?status=${statusCode}`, \"_self\")\r\n  }\r\n\r\n  private handle401(error) {\r\n    console.log(error);\r\n    sessionStorage.clear();\r\n    this.redirect(error.status);\r\n  }\r\n\r\n  private handleDefault(error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nconst globalService = new GlobalService();\r\nexport default globalService;"]},"metadata":{},"sourceType":"module"}